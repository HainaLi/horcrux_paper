\documentclass[sigconf]{acmart}

\fancyhf{} % Remove fancy page headers                                          
%\fancyhead[C]{Anonymous submission \#79 to ACSAC 2017}                                                           
\fancyfoot[C]{\thepage}


\settopmatter{printacmref=false, printccs=true, printfolios=true} % We want page numbers on submissions t}
\input{preamble.tex}

\newcommand*\SecPass{Horcrux}
\newcommand*\Core{core component}
\newcommand*\UI{UI component}
\newcommand*\SwapScan{SwapScan}

\setcopyright{none} % No copyright notice required for submissions   

% DOI
\acmDOI{Not yet assigned} % 10.475/123_4}

% ISBN
\acmISBN{None} % 123-4567-24-567/08/06}

%Conference
\acmConference[ACSAC 2017]{Annual Computer Security Applications Conference}{December 2017}{San Juan, Puerto Rico} 
\acmYear{2017}
%\copyrightyear{2017}

%\acmPrice{0.00}


\begin{document}

\title{Horcrux: A Password Manager for Paranoids}
%\subtitle{[Extended Abstract]}
%\titlenote{Produces the permission block, andcopyright information}
%\subtitle{Extended Abstract}
%\subtitlenote{The full version of the author's guide is available as

\author{Hannah Li, David Evans}
\affiliation{\institution{University of Virginia}}
%\city{\href{https://oblivc.org/dca}{\sf https://oblivc.org/dca}}}
\email{[hannahli, evans]@virginia.edu}

\begin{abstract}
%\hnote{shorten by 2 pages}
Vulnerabilities in password managers are unremitting because current designs provide large attack surfaces, both at the client and server. We describe and evaluate \SecPass, a password manager that is designed holistically to minimize and decentralize trust, while retaining the usability of a traditional password manager. The prototype \SecPass\ client, implemented as a Firefox add-on, is split into two components, with code that has access to the user's master's password and any key material isolated into a small auditable component, separate from the complexity of managing the user interface. Instead of exposing actual credentials to the DOM, a dummy username and password are autofilled by the untrusted component. The trusted component intercepts and modifies POST requests before they are encrypted and sent over the network. To avoid trusting a centralized store, stored credentials are secret-shared over multiple servers. To provide domain and username privacy, while maintaining resilience to off-line attacks on a compromised password store, we incorporate cuckoo hashing in a way that ensures an attacker cannot determine if a guessed master password is correct. Our approach only works for websites that do not manipulate entered credentials in the browser client, so we conducted a large-scale experiment that found the technique appears to be compatible with over 98\% of tested login forms.
%used in Alexa's top million sites. 
\end{abstract}

%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below. 
%

\keywords{password managers, privacy, secure system design, secret sharing}

\maketitle

\input{01_introduction}
\input{02_context}
\input{03_design}
\input{04_security}
\input{05_cost}
\input{06_compatibility}
\input{07_discussion}
\input{08_related}
\input{09_conclusion}

% 
%\section{Acknowledgments}

%
%We thank the anonymous reviewers for their helpful feedback. We also thank Yuchen Zhou for his valuable insights and suggestions on automating \SecPass. (Add organizations who provided financial support.)

%\balancecolumns 

\appendix

%The keystores represents two or more keystores that the user decides to employ at set up in Section \ref{protocol_setup}.  

\begin{figure*}[!ht]
\section{Interactions between Components}
\centering
\includegraphics[height={0.9\textheight}]{Horcrux_protocol.pdf}
\caption{\SecPass\ protocol }
\label{horcrux_diagram}
\end{figure*}
\clearpage


\section{Other Results from Scanning Experiment}\label{extracting_other_information}

Although the goal of our study was to learn about the compatibility of password swapping across the web, as a byproduct of our scan we learned some other interesting things about web logins. Figure~\ref{scan_results_table} summarizes these results.

\shortsection{Protocol}
From an analysis of the URL destination of these login requests, we found that 102,948 (51\%) of logins do not submit a request through HTTPS protocol, which exposes the username and password to man-in-the-middle attacks. 

\shortsection{AJAX}
When a login form uses AJAX to grab the username and password from the form, a header named "X-Requested-With" with a value "XMLHTTPRequest" could be seen in the request.  \SwapScan\ used this property to identify 15,707
 (8\%) websites using AJAX requests, which indicates that JavaScript is used to submit the form data. This is a significant portion of websites that are compatible with \SecPass, but potentially incompatible with other secure login mechanisms, such as Secure Filling~\cite{Silver2014}. Submitting a form through JavaScript also means that the JavaScript may or may not consider the form action; even if a password manager ensure that the action is secure, it may not be actually used. 

\shortsection{Form action}
Traditional password managers check the form action to ensure that the credentials are being submitted to the correct protocol and domain. Out of the login forms that were scanned, 18,628 (10\%) percent of the forms did not have an action listed. For these sites, a non-\SecPass\ password manager would not be able to check the action to ensure that the credentials are headed to the correct domain. Since static analysis of JavaScript is difficult, the only way to ensure the correct destination for credentials is to dynamically check them, which \SecPass\ does naturally.

\begin{figure}[h]
\begin{center}
\begin{tabular}{ |p{5cm}|p{2cm}|  }

 \hline
Category &Percentage\\
 \hline
 HTTPS Protocol & 49\% \\
 HTTP Protocol & 51\% \\
 GET Request & 2\% \\
 POST Request & 98\%\\
 Other Methods & $<$1\% \\
 AJAX Login & 9\% \\
 Non-AJAX Login & 91\% \\
 Action Present & 90\% \\
 Action Not Present & 10\% \\


 \hline
\end{tabular}

\end{center}
\caption{Types of logins found by the scan (percentages are out of the number of completed form submissions).}
\label{scan_results_table}
\end{figure}


\begin{acks}
The authors thank Samuel Havron for coming up with the Horcrux name and contributions to the design, implementation, and presentation. This work was partially funded by an award from the National Science Foundation (1422332) and gifts from Amazon, Google, and Microsoft.
\end{acks}


\makeatletter
\def\url@leostyle{%
  \@ifundefined{selectfont}{\def\UrlFont{\sf}}{\def\UrlFont{\scriptsize\sffamily}}}
\makeatother
%% Now actually use the newly defined style.
\urlstyle{leo}

\bibliographystyle{ACM-Reference-Format}
\bibliography{passsecpaper} 


\end{document}
